<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DoctorScan — Login</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="center">
    <main class="card" role="main" aria-labelledby="title">
      <div class="brand">
        <div class="avatar" aria-hidden="true">
          <svg class="check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
               stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
        </div>
        <h1 id="title">DoctorScan</h1>
        <p class="subtitle">Accede a tu panel de análisis</p>
      </div>

      <form id="form" class="rows" autocomplete="off" novalidate>
        <div>
          <label for="usuario">Usuario</label>
          <div class="field">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                 stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <input id="usuario" class="input" name="usuario" placeholder="Ingresa tu usuario" required />
          </div>
        </div>

        <div>
          <label for="password">Contraseña</label>
          <div class="field">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                 stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
            </svg>
            <input id="password" class="input" type="password" name="password" placeholder="Ingresa tu contraseña" required />
          </div>
        </div>

        <button type="submit" class="btn">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
               stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M5 12h14"></path>
            <path d="m12 5 7 7-7 7"></path>
          </svg>
          Iniciar Sesión
        </button>
        <p class="hint">Prueba con: <b>doctor</b> / <b>123</b></p>
        <p id="msg" class="msg" aria-live="polite"></p>
      </form>
    </main>
  </div>

  <div class="toast" aria-hidden="true" title="nerd.lat">
    <span>Hecho con</span>
    <span style="font-weight:800">nerd.lat</span>
  </div>

  <script>
    // === UTILIDADES ===
    const $ = (s, r=document) => r.querySelector(s);
    const el = (t, attrs={}) => Object.assign(document.createElement(t), attrs);
    const bytesMB = b => (b / 1024 / 1024).toFixed(2);

    // === DASHBOARD ===
    function renderDashboard() {
      document.body.innerHTML = `
        <div class="app-wrap">
          <h1 class="hero-title">Bienvenido, Doctor</h1>
          <p class="hero-sub">Sube una radiografía para análisis de cáncer</p>

          <section class="panel">
            <div class="drop" id="drop">
              <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                   stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="17 8 12 3 7 8"></polyline>
                <line x1="12" y1="3" x2="12" y2="15"></line>
              </svg>
              <h3 class="title">Arrastra o haz clic para subir radiografía</h3>
              <p class="hint">Formatos: JPG, PNG, máximo 5MB</p>
              <input id="file" class="hidden-input" type="file" accept=".jpg,.jpeg,.png" />
            </div>
            <div id="preview" class="preview" aria-live="polite"></div>
          </section>

          <div class="actions">
            <button id="analyzeBtn" class="primary-btn" disabled>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                   stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
              </svg>
              Analizar Imagen
            </button>
          </div>
        </div>
      `;

      const drop = $('#drop');
      const fileInput = $('#file');
      const preview = $('#preview');
      const analyzeBtn = $('#analyzeBtn');

      const VALID = ['image/jpeg', 'image/png'];
      const MAX_MB = 5;

      function setEnabled(ok) {
        analyzeBtn.disabled = !ok;
        analyzeBtn.classList.toggle('enabled', ok);
      }

      function describe(file) {
        preview.innerHTML = '';
        const p = el('p');
        p.textContent = `Archivo: ${file.name} — ${bytesMB(file.size)} MB`;
        preview.appendChild(p);

        if (file.type.startsWith('image/')) {
          const img = el('img');
          img.alt = 'Vista previa';
          img.src = URL.createObjectURL(file);
          preview.appendChild(img);
        }
      }

      function validate(file) {
        if (!file) return { ok: false, msg: 'Ningún archivo seleccionado.' };
        if (!VALID.includes(file.type)) return { ok: false, msg: 'Formato inválido. Usa JPG o PNG.' };
        if (file.size > MAX_MB * 1024 * 1024) return { ok: false, msg: `El archivo supera ${MAX_MB}MB.` };
        return { ok: true };
      }

      function handleFiles(files) {
        const file = files && files[0];
        const res = validate(file);
        if (!res.ok) {
          preview.innerHTML = `<p class="status-err">${res.msg}</p>`;
          setEnabled(false);
          return;
        }
        describe(file);
        preview.insertAdjacentHTML('beforeend', '<p class="status-ok">Listo para analizar.</p>');
        setEnabled(true);
      }

      drop.addEventListener('click', () => fileInput.click());
      fileInput.addEventListener('change', e => handleFiles(e.target.files));
      ['dragenter', 'dragover'].forEach(ev => drop.addEventListener(ev, e => {
        e.preventDefault(); e.stopPropagation();
        drop.style.background = 'rgba(59,130,246,.05)';
      }));
      ['dragleave', 'drop'].forEach(ev => drop.addEventListener(ev, e => {
        e.preventDefault(); e.stopPropagation();
        drop.style.background = 'transparent';
      }));
      drop.addEventListener('drop', e => handleFiles(e.dataTransfer.files));

      analyzeBtn.addEventListener('click', () => {
        if (analyzeBtn.disabled) return;
        const btnText = analyzeBtn.innerHTML;
        analyzeBtn.innerHTML = '<span style="font-weight:800">Analizando…</span>';
        analyzeBtn.style.filter = 'brightness(.95)';
        setTimeout(() => {
          analyzeBtn.innerHTML = btnText;
          analyzeBtn.style.filter = '';
          alert('✅ Análisis de demostración completado.');
        }, 900);
      });
    }

    // === LOGIN ===
    const form = document.getElementById('form');
    const msg = document.getElementById('msg');

    form.addEventListener('submit', e => {
      e.preventDefault();
      const user = document.getElementById('usuario').value.trim();
      const pass = document.getElementById('password').value.trim();

      if (user === 'doctor' && pass === '123') {
        msg.textContent = '¡Bienvenido, ' + user + '!';
        msg.className = 'msg ok';
        setTimeout(renderDashboard, 400);
      } else {
        msg.textContent = 'Credenciales inválidas';
        msg.className = 'msg error';
      }
    });
  </script>
</body>
</html>
